<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Gitcoins Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Gitcoins Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-41298772-2","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-41298772-2"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-41298772-2",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Gitcoins" href="/opensearch.xml">
<link rel="icon" href="/img/pwa/manifest-icon-512.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#20232a">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#20232a">
<link rel="apple-touch-icon" href="/img/pwa/manifest-icon-512.png">
<link rel="mask-icon" href="/img/pwa/manifest-icon-512.png" color="#06bcee">
<meta name="msapplication-TileImage" href="/img/pwa/manifest-icon-512.png">
<meta name="msapplication-TileColor" content="#20232a">
<script src="https://cdn.jsdelivr.net/npm/focus-visible@5.2.0/dist/focus-visible.min.js" defer="defer"></script>
<script src="https://snack.expo.io/embed.js" defer="defer"></script><title data-react-helmet="true">TLS Handshake Â· Gitcoins</title><meta data-react-helmet="true" property="og:url" content="https://www.gitcoins.io/docs/next/tls-handshake"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:image" content="https://reactnative.dev/img/logo-og.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="twitter:image" content="https://reactnative.dev/img/logo-og.png"><meta data-react-helmet="true" name="twitter:site" content="gitcoins@outlook.com"><meta data-react-helmet="true" property="og:title" content="TLS Handshake Â· Gitcoins"><meta data-react-helmet="true" name="description" content="the handshake of TLS"><meta data-react-helmet="true" property="og:description" content="the handshake of TLS"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://www.gitcoins.io/docs/next/tls-handshake"><link data-react-helmet="true" rel="alternate" href="https://www.gitcoins.io/docs/next/tls-handshake" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://www.gitcoins.io/docs/next/tls-handshake" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.cacad23a.css">
<link rel="stylesheet" href="/assets/css/main.811c02d1.css">
<link rel="preload" href="/assets/js/styles.3fa3e4cb.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.732cbfdd.js" as="script">
<link rel="preload" href="/assets/js/main.8cf8082c.js" as="script">
<link rel="preload" href="/assets/js/1.5084d0fe.js" as="script">
<link rel="preload" href="/assets/js/2.5c6b8c75.js" as="script">
<link rel="preload" href="/assets/js/3.a4b8855e.js" as="script">
<link rel="preload" href="/assets/js/1be78505.9bb3edac.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.1fa0d83e.js" as="script">
<link rel="preload" href="/assets/js/17896441.09ac5962.js" as="script">
<link rel="preload" href="/assets/js/cbe7cbbb.c2439aa5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_3wvD">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/header_logo.svg" alt="React Native" class="themedImage_Ir0T themedImage--light_2_E0 navbar__logo"><img src="/img/header_logo.svg" alt="React Native" class="themedImage_Ir0T themedImage--dark_2JiM navbar__logo"><strong class="navbar__title">Gitcoins</strong></a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link" href="/docs/next/build-docusarurs-website">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/next/tls-handshake">Next</a></li><li><a class="dropdown__link" href="/docs/getting-started">0.64</a></li><li><a class="dropdown__link" href="/docs/0.63/getting-started">0.63</a></li><li><a class="dropdown__link" href="/versions">All versions</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__link--active" href="/docs/next/getting-started">Docs</a><a class="navbar__item navbar__link" href="/docs/next/components-and-apis">Components</a><a class="navbar__item navbar__link" href="/docs/next/accessibilityinfo">API</a><a class="navbar__item navbar__link" href="/help">Community</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a href="https://github.com/vulnsystem/www.gitcoins.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2XYw"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_2wFP">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_2wFP">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/header_logo.svg" alt="React Native" class="themedImage_Ir0T themedImage--light_2_E0 navbar__logo"><img src="/img/header_logo.svg" alt="React Native" class="themedImage_Ir0T themedImage--dark_2JiM navbar__logo"><strong class="navbar__title">Gitcoins</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/next/getting-started">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/next/components-and-apis">Components</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/next/accessibilityinfo">API</a></li><li class="menu__list-item"><a class="menu__link" href="/help">Community</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/next/tls-handshake">Next</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/getting-started">0.64</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.63/getting-started">0.63</a></li><li class="menu__list-item"><a class="menu__link" href="/versions">All versions</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/vulnsystem/www.gitcoins.io" target="_blank" rel="noopener noreferrer" class="menu__link navbar-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_3jyA"><div class="docSidebarContainer_3jRz" role="complementary"><div class="sidebar_2j-V"><div class="menu menu--responsive thin-scrollbar menu_1Xkn"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Vtis" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Docusaurus</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/build-docusarurs-website">Build Docusarurs Website</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/github-getting-started">Github getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/trigger-deployment-actions">Triggering deployment with GitHub Actions</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Security</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/ssl-tls-overview">Overview of SSL/TLS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/symmetric-cryptography">Symmetric Cryptography</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/asymmetric-cryptography">Asymmetric Cryptography</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/next/tls-handshake">TLS Handshake</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/create-certificates">Create Certificates</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/openssl-labs">Openssl Labs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/browser-authentication">Browser authentication</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/mutual-authentication">one-way and two-way(mutual) handshake</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">The Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/getting-started">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/intro-react-native-components">Core Components and Native Components</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/intro-react">React Fundamentals</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/handling-text-input">Handling Text Input</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/using-a-scrollview">Using a ScrollView</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/using-a-listview">Using List Views</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/troubleshooting">Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/platform-specific-code">Platform Specific Code</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/more-resources">More Resources</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Environment setup</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/environment-setup">Setting up the development environment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/integration-with-existing-apps">Integration with Existing Apps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/integration-with-android-fragment">Integration with an Android Fragment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/building-for-tv">Building For TV Devices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/out-of-tree-platforms">Out-of-Tree Platforms</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Workflow</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/running-on-device">Running On Device</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/fast-refresh">Fast Refresh</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/debugging">Debugging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/symbolication">Symbolicating a stack trace</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/testing-overview">Testing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/libraries">Using Libraries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/typescript">Using TypeScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/upgrading">Upgrading to new versions</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Design</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/style">Style</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/height-and-width">Height and Width</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/flexbox">Layout with Flexbox</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/images">Images</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/colors">Color Reference</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Interaction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/handling-touches">Handling Touches</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/navigation">Navigating Between Screens</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/animations">Animations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/gesture-responder-system">Gesture Responder System</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Inclusion</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/accessibility">Accessibility</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Performance</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/performance">Performance Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/optimizing-flatlist-configuration">Optimizing Flatlist Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/ram-bundles-inline-requires">RAM Bundles and Inline Requires</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/profiling">Profiling</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/profile-hermes">Profiling with Hermes</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">JavaScript Runtime</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/javascript-environment">JavaScript Environment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/timers">Timers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/hermes">Using Hermes</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Connectivity</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/network">Networking</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/security">Security</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Native Modules</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/native-modules-intro">Native Modules Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/native-modules-android">Android Native Modules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/native-modules-ios">iOS Native Modules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/native-modules-setup">Native Modules NPM Package Setup</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Native Components</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/native-components-android">Android Native UI Components</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/native-components-ios">iOS Native UI Components</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/direct-manipulation">Direct Manipulation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides (Android)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/headless-js-android">Headless JS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/signed-apk-android">Publishing to Google Play Store</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides (iOS)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/linking-libraries-ios">Linking Libraries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/running-on-simulator-ios">Running On Simulator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/communication-ios">Communication between native and React Native</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/app-extensions">App Extensions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/publishing-to-app-store">Publishing to Apple App Store</a></li></ul></li></ul></div></div></div><main class="docMainContainer_28SP"><div class="container padding-vert--lg docItemWrapper_3ZSj"><div class="row"><div class="col docItemCol_2rXS"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for Gitcoins <strong>Next</strong> version.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/docs/getting-started">latest version</a></strong> (0.64).</div></div><div class="docItemContainer_1EXp"><article><div><span class="badge badge--secondary">Version: Next</span></div><header><h1 class="docTitle_1vX4">TLS Handshake</h1></header><div class="markdown"><blockquote><p>Copyright: the following content is totally copy from the <a href="https://dev.to/techschoolguru/a-complete-overview-of-ssl-tls-and-its-cryptographic-system-36pd" target="_blank" rel="noopener noreferrer">TECHSCHOOL</a>.</p></blockquote><p>OK, so now with all the knowledge weâ€™ve gained so far, letâ€™s take a closer look at how theyâ€™re used in the TLS handshake protocol.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2Cjg" id="full-handshake"></a>Full handshake<a class="hash-link" href="#full-handshake" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2Cjg" id="client-hello"></a>client hello<a class="hash-link" href="#client-hello" title="Direct link to heading">#</a></h3><p><img alt="client-hello" src="/assets/images/client-hello-5f178cc8168dca75a790312205079521.png">
The TLS 1.3 full handshake starts with a hello message that the client sends to the server. Actually this message contains a lot of things, but here I just list some important information:</p><ol><li>First, a list of protocol version that client supports.</li><li>Then a list of supported AEAD symmetric cipher suites. In this case, there are 2 options: AES-256-GCM or CHACHA20-POLY1305</li><li>After that, thereâ€™s a list of supported key exchange groups. For example, this client supports both Finite field Diffie-Hellman Ephemeral and Elliptic-Curve Diffie-Hellman Ephemeral.</li><li>Thatâ€™s why client also shares its 2 public keys, 1 for Diffie-Hellman, and the other for Elliptic-Curve Diffie-Hellman. This way, the server will be able to compute the shared secret key no mater what algorithm it chooses.</li><li>The last field client sends in this message is a list of signature algorithms it supports. This is for server to choose which algorithm it should use to sign the whole handshake. We will see how it works in a bit.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2Cjg" id="server-hello"></a>server hello<a class="hash-link" href="#server-hello" title="Direct link to heading">#</a></h3><p><img alt="server-hello" src="/assets/images/server-hello-383fdc3155af72e60fb73d0ad739b6be.png">
After receiving the client hello message, the server also sends back its hello message,which contains:</p><ul><li>The selected protocol version TLS 1.3</li><li>The selected cipher suites: AES-256-GCM</li><li>The selected key exchange method: Diffie-Hellman Ephemeral</li><li>And the serverâ€™s public key for that chosen method.</li><li>The next field is a request for the clientâ€™s certificate, which is optional and will only be sent if the server wants to authenticate the client by its certificate.</li><li>Normally on a HTTPS website, only the server side needs to send its certificate to the client. And that is sent in the next field of this message.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2Cjg" id="authentication-messages"></a>authentication messages<a class="hash-link" href="#authentication-messages" title="Direct link to heading">#</a></h3><p><img alt="authentication-messages" src="/assets/images/authentication-messages-1d5c4acd32a659f026ee9e1142f2d32d.png"></p><ul><li>The next field is certificate verify, which is, in fact, the signature of the entire handshake up to this point. Hereâ€™s how it is generated: The whole data from the beginning of the handshake up to the certificate request is called a handshake context. We concatenate this context with the serverâ€™s certificate, hash it, and sign the hash value with the serverâ€™s private key using 1 of the signature algorithms that the client supports.</li><li>In a similar fashion, the server finish is generated by concatenating the handshake context, the certificate, and the certificate verify, hash it, and put the hash value through the MAC algorithm of the chosen cipher suite. The result is the MAC of the entire handshake.</li></ul><p>Here the server certificate, certificate verify, and server finish are called authentication messages, because they are used to authenticate the server. With the signature and MAC of the entire handshake, TLS 1.3 is safe against several types of man-in-the-middle Downgrade attacks.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2Cjg" id="client-finish"></a>client finish<a class="hash-link" href="#client-finish" title="Direct link to heading">#</a></h3><p><img alt="client-finish" src="/assets/images/client-finish-de8b8b7b9e61caf41c29350b95345015.png">
Now after the client receives the hello message from server, it will validate the serverâ€™s certificate with the root authority, and check the signature and MAC of the entire handshake to make sure itâ€™s not been tampered with.
If everything is good then the client sends its finish message with the MAC of the entire handshake up to this point, and optionally the clientâ€™s certificate and certificate verify in case the server has requested.
And thatâ€™s the whole flow of the full TLS handshake.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2Cjg" id="abbreviated-handshake-with-psk-resumption"></a>Abbreviated handshake with PSK resumption<a class="hash-link" href="#abbreviated-handshake-with-psk-resumption" title="Direct link to heading">#</a></h2><p>To improve the performance, the client and server donâ€™t always go through this full handshake. Sometimes, they perform abbreviated handshake by using preshared key resumption.
The idea is: after the previous handshake, the client and server already know each other, so they donâ€™t need to authenticate again.
So the server may send one or multiple session tickets to the client, which can be used as the pre-shared key (PSK) identity in the next handshake. It goes with a ticket lifetime as well as some other information.
<img alt="PSK-resumption" src="/assets/images/PSK-resumption-4c458fc4d10424a22cc52a6b8f944bd3.png">
Now in the next handshake, the client will send a simple hello message, which contains:</p><ul><li>A list of PSK identities (or tickets) obtained from the previous handshake</li><li>A PSK key exchange mode, which can be either PSK only, or PSK with Diffie-Hellman.</li><li>If the PSK with Diffie-Hellman mode is used, then the client also needs to share its Diffie-Hellman public key. This will provide perfect forward secrecy, as well as allow the server to fallback to full handshake if needed.</li></ul><p>When the server receives this client hello message, it sends back its hello with:</p><ul><li>The selected pre-shared key identity</li><li>The optional Diffie-Hellman public key of the server</li><li>And the server Finish just like in the full handshake.
Finally the client sends back its Finish, and thatâ€™s the end of the PSK resumption.
As you can see, thereâ€™s no certificate authentication between client and server in this abbreviated handshake.
This also opens up an opportunity for zero round-trip time (0-RTT) data, which means, the client doesnâ€™t need to wait for the handshake to complete to send its first application data to the server.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2Cjg" id="0-rtt-handshake"></a>0-RTT handshake<a class="hash-link" href="#0-rtt-handshake" title="Direct link to heading">#</a></h2><p><img alt="rrt-handshake" src="/assets/images/rrt-handshake-bfb98c9fc2692549a92050e667ebe795.png">
In 0-RTT, client sends the application data together with the client hello message. This data is encrypted using the key derived from the first PSK in the ticket list.
And it also adds 1 more field: early data indication to tell the server that thereâ€™s early application data being sent along.
If the server accepts this 0-RTT request, it will sends back the server hello just like in the normal PSK resumption, and optionally some application data as well.
The client will finish with a message containing the MAC, and an end-of-early-data indicator. Thatâ€™s how 0 round-trip time works in TLS 1.3.
Its pros is reduce the latency by 1 round trip time. But the cons is openning up a potential threat of replay attack. Which means, the hacker can just copy and send the same encrypted 0-RTT request to the server multiple times. To avoid this, the server application must be implemented in a way thatâ€™s resilient to duplicate requests.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2Cjg" id="tls-13-vs-tls-12"></a>TLS 1.3 vs TLS 1.2<a class="hash-link" href="#tls-13-vs-tls-12" title="Direct link to heading">#</a></h2><p>Now before we finish, letâ€™s do a quick comparison of TLS 1.3 and TLS 1.2 to see whatâ€™s new!
<img alt="tls-new-version" src="/assets/images/tls-new-version-e3683416410c5a0103a152a4f29e8bf7.png"></p><ol><li>TLS 1.3 has safer key exchange mechanisms, where the vulnerable RSA and other static key exchange methods are removed, leaving only ephemeral Diffie-Hellman or Elliptic-Curve Diffie-Hellman remain, therefore achieved perfect forward secrecy.</li><li>TLS 1.3 handshake is at least 1 round-trip faster than TLS 1.2.</li><li>Symmetric encryption in TLS 1.3 is more secure because AEAD cipher suite is mandatory, and it also removes some weak algorithms from the list such as Block Cipher Mode (CBC), RC4, or Triple DES.</li><li>The cipher suite in TLS 1.3 is also simpler, since it only contains the AEAD algorithm and a hash algorithm. The key exchange and signature algorithms are moved to separate fields. While in TLS 1.2, theyâ€™re merged into the cipher suite. This makes the number of recommended cipher suites become too big, 37 options in TLS 1.2 if i remember correctly. While in TLS 1.3, there are only 5.</li><li>Next, TLS 1.3 also give us stronger signature, since it signs the entire handshake, not just cover some part of it as in TLS 1.2.</li><li>Last but not least, Elliptic-curve cryptography gets a significant attention in TLS 1.3, with some better curves algorithm added, such as Edward-curve digital signature algorithm, which is faster without sacrificing security.</li></ol><p>And thatâ€™s everything I want to share with you in this article. Thanks for reading, and Iâ€™ll catch you guys in the next one!</p></div></article><div class="docMetadata margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/vulnsystem/www.gitcoins.io/blob/documentation/website/../docs/tls-handshake.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_1CBY" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-05-22T08:11:38.000Z" class="lastUpdatedDate_Xku4">5/22/2021</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/next/asymmetric-cryptography"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Asymmetric Cryptography</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/next/create-certificates"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Create Certificates Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3J2a thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#full-handshake" class="table-of-contents__link">Full handshake</a><ul><li><a href="#client-hello" class="table-of-contents__link">client hello</a></li><li><a href="#server-hello" class="table-of-contents__link">server hello</a></li><li><a href="#authentication-messages" class="table-of-contents__link">authentication messages</a></li><li><a href="#client-finish" class="table-of-contents__link">client finish</a></li></ul></li><li><a href="#abbreviated-handshake-with-psk-resumption" class="table-of-contents__link">Abbreviated handshake with PSK resumption</a></li><li><a href="#0-rtt-handshake" class="table-of-contents__link">0-RTT handshake</a></li><li><a href="#tls-13-vs-tls-12" class="table-of-contents__link">TLS 1.3 vs TLS 1.2</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tutorial">Tutorial</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/components-and-apis">Components and APIs</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/more-resources">More Resources</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/help">The React Native Community</a></li><li class="footer__item"><a class="footer__link-item" href="/showcase">Who&#x27;s using React Native?</a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/react-native" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ask Questions on Stack Overflow</a></li><li class="footer__item"><a href="https://github.com/facebook/react-native/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contributor Guide</a></li><li class="footer__item"><a href="https://dev.to/t/reactnative" target="_blank" rel="noopener noreferrer" class="footer__link-item">DEV Community</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Find us</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://twitter.com/reactnative" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://github.com/vulnsystem/www.gitcoins.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://reactjs.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">React</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of Service</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1gX9"><img src="/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_Ir0T themedImage--light_2_E0 footer__logo"><img src="/img/oss_logo.png" alt="Facebook Open Source Logo" class="themedImage_Ir0T themedImage--dark_2JiM footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2021 Facebook, Inc.</div></div></div></footer></div>
<script src="/assets/js/styles.3fa3e4cb.js"></script>
<script src="/assets/js/runtime~main.732cbfdd.js"></script>
<script src="/assets/js/main.8cf8082c.js"></script>
<script src="/assets/js/1.5084d0fe.js"></script>
<script src="/assets/js/2.5c6b8c75.js"></script>
<script src="/assets/js/3.a4b8855e.js"></script>
<script src="/assets/js/1be78505.9bb3edac.js"></script>
<script src="/assets/js/935f2afb.1fa0d83e.js"></script>
<script src="/assets/js/17896441.09ac5962.js"></script>
<script src="/assets/js/cbe7cbbb.c2439aa5.js"></script>
</body>
</html>